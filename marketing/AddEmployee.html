<!DOCTYPE html>
<html>
<head>
<base target="_top">
<style>
  body { font-family: 'Segoe UI', sans-serif; background: #f4f7f9; padding:20px; }
  .container { max-width: 600px; margin:auto; background:white; padding:25px; border-radius:10px; box-shadow:0 4px 12px rgba(0,0,0,0.1); }
  h2 { text-align:center; color:#333; }
  label { display:block; margin-top:15px; font-weight:bold; }
  input, select, button { width:100%; padding:8px; border-radius:5px; border:1px solid #ccc; margin-top:5px; box-sizing:border-box; }
  button { margin-top:20px; background:#4285f4; color:white; border:none; border-radius:5px; cursor:pointer; }
  button:hover { background:#3367d6; }
  .back { text-align:center; margin-top:20px; }
  a.button { padding:10px 20px; background:#4285f4; color:white; border-radius:5px; text-decoration:none; }
  a.button:hover { background:#3367d6; }
</style>
</head>
<body>
<div class="container">
  <h2>Add Employee</h2>

  <label>Email:</label>
  <input type="email" id="email" required placeholder="Enter employee email">

  <label>Name:</label>
  <input type="text" id="name" required placeholder="Enter employee name">

  <label>Role:</label>
  <select id="role" required>
    <option value="">Select role</option>
    <option value="Admin">Admin</option>
    <option value="Employee">Employee</option>
  </select>

  <label>Employee Code:</label>
  <input type="text" id="code" required placeholder="Enter employee code">

  <button onclick="submitEmployee()">Add Employee</button>

  <div class="back">
    <a class="button" href="<?= webAppUrl ?>?page=home">Back Home</a>
  </div>
</div>

<script>
function submitEmployee() {
  const email = document.getElementById("email").value.trim();
  const name = document.getElementById("name").value.trim();
  const role = document.getElementById("role").value;
  const code = document.getElementById("code").value.trim();

  if(!email || !name || !role || !code){
    alert("Please fill all fields");
    return;
  }

  // Disable button to prevent multiple clicks
  const btn = document.querySelector("button");
  btn.disabled = true;

  // Send data in the correct order: [email, name, code, role]
  google.script.run.withSuccessHandler(function(res){
    if(res){
      alert("Employee added successfully!");
      document.getElementById("email").value = "";
      document.getElementById("name").value = "";
      document.getElementById("role").value = "";
      document.getElementById("code").value = "";
    } else {
      alert("Failed to add employee. Email might already exist.");
    }
    btn.disabled = false;
  }).addEmployee([email, name, code, role]);
}
</script>

</body>
</html>
